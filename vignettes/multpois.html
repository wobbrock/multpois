<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jacob O. Wobbrock" />

<meta name="date" content="2025-01-24" />

<title>Analyzing nominal responses using the multinomial-Poisson trick</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Analyzing nominal responses using the
multinomial-Poisson trick</h1>
<h4 class="author">Jacob O. Wobbrock</h4>
<h4 class="date">2025-01-24</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette shows how to use the <code>multpois</code> package for
analyzing nominal response data. Nominal responses, sometimes called
multinomial responses, are unordered categories. In certain experiments
or surveys, the dependent variable can be one of <em>N</em>
categories.</p>
<p>For example, let’s say we ask people what their favorite ice cream
flavor is: vanilla, chocolate, or strawberry. This three-category
response would be a <em>polytomous dependent variable</em>. Also, let’s
say we wish to ask both adults and children about their favorite ice
cream flavors to see if there is a difference by age group. We would
then have a two-level between-subjects factor, <em>Age</em>. If we ask
each respondent only once, this data set would represent a one-way
between-subjects design. But perhaps we ask each participant once
<em>each season</em>—in fall, winter, spring, and summer—to see if their
responses vary by season. Now we would have a four-level within-subjects
factor, <em>Season</em>, resulting in repeated measures, since each
respondent would be asked four times.</p>
<p>The <code>multpois</code> package helps us analyze this type of data,
where the dependent variable is nominal. It does so by modeling nominal
responses as counts of category choices and uses mixed-effects Poisson
regression to analyze these counts (Baker 1994, Chen &amp; Kuo 2001).
This technique is known as the multinomial-Poisson transformation
(Guimaraes 2004) or trick (Lee et al. 2017).</p>
<p>R already provides options for the following situations:</p>
<ul>
<li><p>If the response is dichotomous, and the factors are only
between-subjects, we can build a model using <code>glm</code> with
<code>family=binomial</code> from the base <code>stats</code> package.
The <code>Anova</code> function from the <code>car</code> package can be
used to produce main effects and interactions. The <code>emmeans</code>
function from the <code>emmeans</code> package can be used to produce
<em>post hoc</em> pairwise comparisons.</p></li>
<li><p>If the response is polytomous, and the factors are only
between-subjects, we can build a model using <code>multinom</code> from
the <code>nnet</code> package. The <code>Anova</code> function from the
<code>car</code> package can be used to produce main effects and
interactions. However, we cannot use the <code>emmeans</code> function
from the <code>emmeans</code> package in the usual fashion. An approach
to this issue by <code>emmeans</code> package author Russ Lenth is
offered below.</p></li>
<li><p>If the response is dichotomous, and one or more factors is
within-subjects, we can build a model using <code>glmer</code> with
<code>family=binomial</code> from the <code>lme4</code> package. The
<code>Anova</code> function from the <code>car</code> package can be
used to produce main effects and interactions. The <code>emmeans</code>
function from the <code>emmeans</code> package can be used to produce
<em>post hoc</em> pairwise comparisons.</p></li>
<li><p>If the response is polytomous, and one or more factors is
within-subjects, there is no easy option similar to the three above. The
<code>multinom</code> function in <code>nnet</code> cannot accept random
factors to handle repeated measures, and the <code>glmer</code> function
in <code>lme4</code> does not offer a <code>family=multinomial</code>
option. This package was created to address this case in particular,
although it can address the above three cases, also.</p></li>
</ul>
<p>The first four analyses below illustrate 2×2 designs having between-
and within-subjects factors and dichotomous and polytomous responses.
(The functions in <code>multpois</code> are not limited to 2×2 designs;
any number of between- and within-subjects factors can be used.) The
first three examples first use existing R solutions to which the results
from <code>multpois</code> functions can be compared.</p>
<p>The fifth example returns to our ice cream scenario, above, and
analyzes a mixed factorial design with one between-subjects factor
(<code>Age</code>) and one within-subjects factor
(<code>Season</code>).</p>
</div>
<div id="contents" class="section level2">
<h2>Contents</h2>
<ol style="list-style-type: decimal">
<li><a href="#references">References</a>: Relevant academic references
for this vignette.</li>
<li><a href="#libraries">Libraries</a>: External R libraries needed for
this vignette.</li>
<li><a href="#bs2">Between-subjects 2×2 design with dichotomous
response</a>: Analysis of the <code>bs2</code> data set.</li>
<li><a href="#bs3">Between-subjects 2×2 design with polytomous
response</a>: Analysis of the <code>bs3</code> data set.</li>
<li><a href="#ws2">Within-subjects 2×2 design with dichotomous
response</a>: Analysis of the <code>ws2</code> data set.</li>
<li><a href="#ws3">Within-subjects 2×2 design with polytomous
response</a>: Analysis of the <code>ws3</code> data set.</li>
<li><a href="#ice">Mixed factorial 2×2 design with polytomous
response</a>: Analysis of the <code>icecream</code> data set.</li>
</ol>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Baker, S.G. (1994). The multinomial-Poisson transformation. <em>The
Statistician 43</em> (4), pp. 495-504. <a href="https://doi.org/10.2307/2348134" class="uri">https://doi.org/10.2307/2348134</a></p>
<p>Chen, Z. and Kuo, L. (2001). A note on the estimation of the
multinomial logit model with random effects. <em>The American
Statistician</em> 55 (2), pp. 89-95. <a href="https://www.jstor.org/stable/2685993" class="uri">https://www.jstor.org/stable/2685993</a></p>
<p>Guimaraes, P. (2004). Understanding the multinomial-Poisson
transformation. <em>The Stata Journal</em> 4 (3), pp. 265-273. <a href="https://www.stata-journal.com/article.html?article=st0069" class="uri">https://www.stata-journal.com/article.html?article=st0069</a></p>
<p>Lee, J.Y.L., Green, P.J.,and Ryan, L.M. (2017). On the “Poisson
trick” and its extensions for fitting multinomial regression models.
<em>arXiv preprint</em> available at <a href="https://doi.org/10.48550/arXiv.1707.08538" class="uri">https://doi.org/10.48550/arXiv.1707.08538</a></p>
</div>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<p>These are the libraries needed for running the code in this
vignette:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code></pre></div>
<p>Let’s also load our library:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(multpois)</span></code></pre></div>
<p><a name="bs2"></a></p>
</div>
<div id="between-subjects-22-design-with-dichotomous-response" class="section level2">
<h2>Between-subjects 2×2 design with dichotomous response</h2>
<p>Let’s load and prepare our first data set, a 2×2 between-subjects
design with a dichotomous response. Factor <code>X1</code> has levels
<code>{a, b}</code>, factor <code>X2</code> has levels
<code>{c, d}</code>, and response <code>Y</code> has categories
<code>{yes, no}</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">data</span>(bs2, <span class="at">package=</span><span class="st">&quot;multpois&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>bs2<span class="sc">$</span>PId <span class="ot">=</span> <span class="fu">factor</span>(bs2<span class="sc">$</span>PId)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>bs2<span class="sc">$</span>Y <span class="ot">=</span> <span class="fu">factor</span>(bs2<span class="sc">$</span>Y, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>bs2<span class="sc">$</span>X1 <span class="ot">=</span> <span class="fu">factor</span>(bs2<span class="sc">$</span>X1)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>bs2<span class="sc">$</span>X2 <span class="ot">=</span> <span class="fu">factor</span>(bs2<span class="sc">$</span>X2)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">contrasts</span>(bs2<span class="sc">$</span>X1) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">contrasts</span>(bs2<span class="sc">$</span>X2) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span></code></pre></div>
<p>Let’s visualize this data set using a mosaic plot:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> Y, <span class="at">data=</span>bs2)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Y by X1, X2&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 1. Proportions of yes (green) and no (pink) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." src="data:image/png;base64,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" alt="Figure 1. Proportions of yes (green) and no (pink) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." />
<div class="figcaption"><strong>Figure 1.</strong> Proportions of
<code>yes</code> (green) and <code>no</code> (pink) responses in four
conditions: <code>{a, c}</code>, <code>{a, d}</code>,
<code>{b, c}</code>, and <code>{b, d}</code>.</div>
</div>
<p>Given <code>X1</code> and <code>X2</code> are both between-subjects
factors, and <code>Y</code> is a dichotomous response, we can analyze
this data set using conventional logistic regression:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="fu">glm</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data=</span>bs2, <span class="at">family=</span>binomial)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">Anova</span>(m1, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III tests)</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;       LR Chisq Df Pr(&gt;Chisq)  </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; X1      4.4440  1    0.03502 *</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; X2      0.7513  1    0.38606  </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; X1:X2   4.4440  1    0.03502 *</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">emmeans</span>(m1, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)<span class="sc">$</span>contrasts</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;  contrast  estimate    SE  df z.ratio p.value</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;  a c - b c    2.398 0.870 Inf   2.755  0.0352</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;  a c - a d    1.705 0.801 Inf   2.129  0.1661</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt;  a c - b d    1.705 0.801 Inf   2.129  0.1661</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt;  b c - a d   -0.693 0.847 Inf  -0.819  1.0000</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt;  b c - b d   -0.693 0.847 Inf  -0.819  1.0000</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt;  a d - b d    0.000 0.775 Inf   0.000  1.0000</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale. </span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; P value adjustment: holm method for 6 tests</span></span></code></pre></div>
<p>We can also analyze this data set using the multinomial-Poisson
trick, which converts nominal responses to category counts and analyzes
these counts using Poisson regression:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="fu">glm.mp</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data=</span>bs2)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">Anova.mp</span>(m2, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III tests)</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; via the multinomial-Poisson trick</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;        Chisq Df  N Pr(&gt;Chisq)  </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; X1    4.4440  1 60    0.03502 *</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; X2    0.7513  1 60    0.38606  </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; X1:X2 4.4440  1 60    0.03502 *</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">glm.mp.con</span>(m2, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt;    Contrast    Chisq Df  N  p.value</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; 1 a.c - a.d 4.962518  1 30 0.129510</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; 2 a.c - b.c 9.045871  1 30 0.015798</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; 3 a.c - b.d 4.962518  1 30 0.129510</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; 4 a.d - b.c 0.687412  1 30 1.000000</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 5 a.d - b.d 0.000000  1 30 1.000000</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 6 b.c - b.d 0.687412  1 30 1.000000</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: holm method for 6 tests&quot;</span></span></code></pre></div>
<p>The omnibus results from logistic regression and from the
multinomial-Poisson trick match, and the results from the <em>post
hoc</em> pairwise comparisons are similar.</p>
<p><a name="bs3"></a></p>
</div>
<div id="between-subjects-22-design-with-polytomous-response" class="section level2">
<h2>Between-subjects 2×2 design with polytomous response</h2>
<p>Let’s load and prepare our second data set, a 2×2 between-subjects
design with a polytomous response. Factor <code>X1</code> has levels
<code>{a, b}</code>, factor <code>X2</code> has levels
<code>{c, d}</code>, and response <code>Y</code> has categories
<code>{yes, no, maybe}</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">data</span>(bs3, <span class="at">package=</span><span class="st">&quot;multpois&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>bs3<span class="sc">$</span>PId <span class="ot">=</span> <span class="fu">factor</span>(bs3<span class="sc">$</span>PId)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>bs3<span class="sc">$</span>Y <span class="ot">=</span> <span class="fu">factor</span>(bs3<span class="sc">$</span>Y, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>,<span class="st">&quot;maybe&quot;</span>))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>bs3<span class="sc">$</span>X1 <span class="ot">=</span> <span class="fu">factor</span>(bs3<span class="sc">$</span>X1)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>bs3<span class="sc">$</span>X2 <span class="ot">=</span> <span class="fu">factor</span>(bs3<span class="sc">$</span>X2)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">contrasts</span>(bs3<span class="sc">$</span>X1) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">contrasts</span>(bs3<span class="sc">$</span>X2) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span></code></pre></div>
<p>Let’s again visualize the data using a mosaic plot:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> Y, <span class="at">data=</span>bs3)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Y by X1, X2&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 2. Proportions of yes (green), no (pink), and maybe (yellow) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." src="data:image/png;base64,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" alt="Figure 2. Proportions of yes (green), no (pink), and maybe (yellow) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." />
<div class="figcaption"><strong>Figure 2.</strong> Proportions of
<code>yes</code> (green), <code>no</code> (pink), and <code>maybe</code>
(yellow) responses in four conditions: <code>{a, c}</code>,
<code>{a, d}</code>, <code>{b, c}</code>, and <code>{b, d}</code>.</div>
</div>
<p>Given <code>X1</code> and <code>X2</code> are both between-subjects
factors, and <code>Y</code> is a polytomous response, we might wish that
<code>glm</code> had a <code>family=multinomial</code> option analogous
to its <code>family=binomial</code> option, but it does not.
Fortunately, we can analyze polytomous response data for (only)
between-subjects factors using the <code>multinom</code> function from
the <code>nnet</code> package:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>m3 <span class="ot">=</span> <span class="fu">multinom</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data=</span>bs3, <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">Anova</span>(m3, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III tests)</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;       LR Chisq Df Pr(&gt;Chisq)  </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; X1      3.5327  2    0.17096  </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; X2      7.8081  2    0.02016 *</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; X1:X2   4.0039  2    0.13507  </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Unfortunately, <code>emmeans</code> does not work straightforwardly
with <code>multinom</code> models. A solution to this issue from Russ
Lenth, lead author of <code>emmeans</code>, was <a href="https://stackoverflow.com/questions/33316898/r-tukey-posthoc-tests-for-nnet-multinom-multinomial-fit-to-test-for-overall-dif">posted
on StackExchange</a>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>e0 <span class="ot">=</span> <span class="fu">emmeans</span>(m3, <span class="sc">~</span> X1<span class="sc">*</span>X2 <span class="sc">|</span> Y, <span class="at">mode=</span><span class="st">&quot;latent&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>c0 <span class="ot">=</span> <span class="fu">contrast</span>(e0, <span class="at">method=</span><span class="st">&quot;pairwise&quot;</span>, <span class="at">ref=</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">test</span>(c0, <span class="at">joint=</span><span class="cn">TRUE</span>, <span class="at">by=</span><span class="st">&quot;contrast&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;  contrast  df1 df2 F.ratio p.value note</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;  a c - b c   2   8   3.017  0.1056  d  </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt;  a c - a d   2   8   4.552  0.0479  d  </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt;  a c - b d   2   8   4.610  0.0466  d  </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt;  b c - a d   2   8   0.688  0.5298  d  </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;  b c - b d   2   8   0.611  0.5661  d  </span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt;  a d - b d   2   8   1.308  0.3224  d  </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; d: df1 reduced due to linear dependence</span></span></code></pre></div>
<p>We can also analyze this data set using the multinomial-Poisson
trick:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>m4 <span class="ot">=</span> <span class="fu">glm.mp</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">data=</span>bs3)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">Anova.mp</span>(m4, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III tests)</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; via the multinomial-Poisson trick</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;        Chisq Df  N Pr(&gt;Chisq)  </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; X1    3.5327  2 60    0.17096  </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; X2    7.8081  2 60    0.02016 *</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; X1:X2 4.0039  2 60    0.13507  </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">glm.mp.con</span>(m4, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;    Contrast     Chisq Df  N  p.value</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; 1 a.c - a.d 12.172660  2 30 0.013644</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 2 a.c - b.c  6.990329  2 30 0.121376</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 3 a.c - b.d 11.647010  2 30 0.014785</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; 4 a.d - b.c  1.425017  2 30 0.980826</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 5 a.d - b.d  2.804595  2 30 0.738093</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 6 b.c - b.d  1.252756  2 30 0.980826</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: holm method for 6 tests&quot;</span></span></code></pre></div>
<p>Again, the results from multinomial logistic regression and from the
multinomial-Poisson trick match. The results from the <em>post hoc</em>
pairwise comparisons are similar.</p>
<p><a name="ws2"></a></p>
</div>
<div id="within-subjects-22-design-with-dichotomous-response" class="section level2">
<h2>Within-subjects 2×2 design with dichotomous response</h2>
<p>Let’s load and prepare our third data set, a 2×2 within-subjects
design with a dichotomous response. Factor <code>X1</code> has levels
<code>{a, b}</code>, factor <code>X2</code> has levels
<code>{c, d}</code>, and response <code>Y</code> has categories
<code>{yes, no}</code>. Now the <code>PId</code> factor is repeated
across rows, indicating participants were measured repeatedly.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">data</span>(ws2, <span class="at">package=</span><span class="st">&quot;multpois&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>ws2<span class="sc">$</span>PId <span class="ot">=</span> <span class="fu">factor</span>(ws2<span class="sc">$</span>PId)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>ws2<span class="sc">$</span>Y <span class="ot">=</span> <span class="fu">factor</span>(ws2<span class="sc">$</span>Y, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>ws2<span class="sc">$</span>X1 <span class="ot">=</span> <span class="fu">factor</span>(ws2<span class="sc">$</span>X1)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>ws2<span class="sc">$</span>X2 <span class="ot">=</span> <span class="fu">factor</span>(ws2<span class="sc">$</span>X2)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">contrasts</span>(ws2<span class="sc">$</span>X1) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">contrasts</span>(ws2<span class="sc">$</span>X2) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span></code></pre></div>
<p>Let’s visualize this data set using a mosaic plot:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> Y, <span class="at">data=</span>ws2)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Y by X1, X2&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 3. Proportions of yes (green) and no (pink) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." src="data:image/png;base64,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" alt="Figure 3. Proportions of yes (green) and no (pink) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." />
<div class="figcaption"><strong>Figure 3.</strong> Proportions of
<code>yes</code> (green) and <code>no</code> (pink) responses in four
conditions: <code>{a, c}</code>, <code>{a, d}</code>,
<code>{b, c}</code>, and <code>{b, d}</code>.</div>
</div>
<p>Given <code>X1</code> and <code>X2</code> are both within-subjects
factors, and <code>Y</code> is a dichotomous response, we can analyze
this using mixed-effects logistic regression. The function
<code>glmer</code> from the <code>lme4</code> package provides this to
us:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>m5 <span class="ot">=</span> <span class="fu">glmer</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>PId), <span class="at">data=</span>ws2, <span class="at">family=</span>binomial)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">Anova</span>(m5, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III Wald chisquare tests)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;              Chisq Df Pr(&gt;Chisq)   </span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.8553  1   0.355052   </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; X1          0.8553  1   0.355052   </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; X2          6.6368  1   0.009989 **</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; X1:X2       4.3758  1   0.036452 * </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">emmeans</span>(m5, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)<span class="sc">$</span>contrasts</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;  contrast  estimate    SE  df z.ratio p.value</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;  a c - b c   -0.693 0.847 Inf  -0.819  0.8258</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;  a c - a d   -2.773 0.913 Inf  -3.037  0.0143</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;  a c - b d   -0.981 0.833 Inf  -1.177  0.7176</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;  b c - a d   -2.079 0.847 Inf  -2.456  0.0702</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;  b c - b d   -0.288 0.760 Inf  -0.378  0.8258</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;  a d - b d    1.792 0.833 Inf   2.150  0.1262</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale. </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; P value adjustment: holm method for 6 tests</span></span></code></pre></div>
<p>We can also analyze this data set using the multinomial-Poisson
trick, now with an underlying mixed-effects Poisson regression
model:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>m6 <span class="ot">=</span> <span class="fu">glmer.mp</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>PId), <span class="at">data=</span>ws2)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">Anova.mp</span>(m6, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III Wald chisquare tests)</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; via the multinomial-Poisson trick</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt;        Chisq Df  N Pr(&gt;Chisq)   </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; X1    0.8553  1 60   0.355052   </span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; X2    6.6368  1 60   0.009989 **</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; X1:X2 4.3758  1 60   0.036452 * </span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="fu">glmer.mp.con</span>(m6, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;    Contrast    Chisq Df  N  p.value</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 1 a.c - a.d 9.224701  1 30 0.014328</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 2 a.c - b.c 0.670400  1 30 0.825824</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 3 a.c - b.d 1.385304  1 30 0.717600</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 4 a.d - b.c 6.033594  1 30 0.070180</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 5 a.d - b.d 4.622979  1 30 0.126184</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; 6 b.c - b.d 0.143240  1 30 0.825824</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: holm method for 6 tests&quot;</span></span></code></pre></div>
<p>The results from mixed-effects logistic regression and results from
the multinomial-Poisson trick match, including the results from the
<em>post hoc</em> pairwise comparisons.</p>
<p><a name="ws3"></a></p>
</div>
<div id="within-subjects-22-design-with-polytomous-response" class="section level2">
<h2>Within-subjects 2×2 design with polytomous response</h2>
<p>This fourth example illustrates the main reason that the
<code>multpois</code> package was created. Unlike the three examples
above, there are no straightforward options for analyzing nominal
responses with repeated measures and obtaining ANOVA-style results. Some
functions do offer mixed-effects multinomial regression modeling, such
as <code>mblogit</code> in the <code>mclogit</code> package, but they do
not enable ANOVA-style output. Other advanced methods exist, such as
Markov Chain Monte Carlo (MCMC) methods in the <code>MCMCglmm</code>
package, which does have a <code>family=multinomial</code> option, but
these Bayesian methods are complex and deviate from the approaches
illustrated above. Fortunately, we can again use the multinomial-Poisson
trick.</p>
<p>Let’s load and prepare our fourth data set, a 2×2 within-subjects
design with a polytomous response. Factor <code>X1</code> has levels
<code>{a, b}</code>, factor <code>X2</code> has levels
<code>{c, d}</code>, and response <code>Y</code> has categories
<code>{yes, no, maybe}</code>. Again, the <code>PId</code> factor is
repeated across rows, indicating participants were measured
repeatedly.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">data</span>(ws3, <span class="at">package=</span><span class="st">&quot;multpois&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>ws3<span class="sc">$</span>PId <span class="ot">=</span> <span class="fu">factor</span>(ws3<span class="sc">$</span>PId)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>ws3<span class="sc">$</span>Y <span class="ot">=</span> <span class="fu">factor</span>(ws3<span class="sc">$</span>Y, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>,<span class="st">&quot;no&quot;</span>,<span class="st">&quot;maybe&quot;</span>))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>ws3<span class="sc">$</span>X1 <span class="ot">=</span> <span class="fu">factor</span>(ws3<span class="sc">$</span>X1)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>ws3<span class="sc">$</span>X2 <span class="ot">=</span> <span class="fu">factor</span>(ws3<span class="sc">$</span>X2)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">contrasts</span>(ws3<span class="sc">$</span>X1) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">contrasts</span>(ws3<span class="sc">$</span>X2) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span></code></pre></div>
<p>Let’s visualize this data set using a mosaic plot:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> Y, <span class="at">data=</span>ws3)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Y by X1, X2&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>,<span class="st">&quot;pink&quot;</span>,<span class="st">&quot;lightyellow&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 4. Proportions of yes (green), no (pink), and maybe (yellow) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." src="data:image/png;base64,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" alt="Figure 4. Proportions of yes (green), no (pink), and maybe (yellow) responses in four conditions: {a, c}, {a, d}, {b, c}, and {b, d}." />
<div class="figcaption"><strong>Figure 4.</strong> Proportions of
<code>yes</code> (green), <code>no</code> (pink), and <code>maybe</code>
(yellow) responses in four conditions: <code>{a, c}</code>,
<code>{a, d}</code>, <code>{b, c}</code>, and <code>{b, d}</code>.</div>
</div>
<p>Because <code>multinom</code> from the <code>nnet</code> package
cannot accept random factors, it cannot model repeated measures. And
because <code>glmer</code> from the <code>lme4</code> package has no
<code>family=multinomial</code> option, it cannot model polytomous
responses. Fortunately, with the multinomial-Poisson trick, we can
analyze polytomous responses from repeated measures:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>m7 <span class="ot">=</span> <span class="fu">glmer.mp</span>(Y <span class="sc">~</span> X1<span class="sc">*</span>X2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>PId), <span class="at">data=</span>ws3)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">Anova.mp</span>(m7, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III Wald chisquare tests)</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; Response: Y</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; via the multinomial-Poisson trick</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;        Chisq Df  N Pr(&gt;Chisq)  </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; X1    6.6734  2 60    0.03555 *</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; X2    6.6713  2 60    0.03559 *</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; X1:X2 0.5514  2 60    0.75905  </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="fu">glmer.mp.con</span>(m7, pairwise <span class="sc">~</span> X1<span class="sc">*</span>X2, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt;    Contrast     Chisq Df  N  p.value</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; 1 a.c - a.d  6.033960  2 30 0.244735</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; 2 a.c - b.c  6.034054  2 30 0.244735</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 3 a.c - b.d 10.676280  2 30 0.028830</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 4 a.d - b.c  0.000000  2 30 1.000000</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 5 a.d - b.d  1.590911  2 30 1.000000</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 6 b.c - b.d  1.589577  2 30 1.000000</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: holm method for 6 tests&quot;</span></span></code></pre></div>
<p><a name="ice"></a></p>
</div>
<div id="mixed-factorial-22-design-with-polytomous-response" class="section level2">
<h2>Mixed factorial 2×2 design with polytomous response</h2>
<p>This fifth and final example is also the reason that the
<code>multpois</code> package was created, since we have a polytomous
response, one between-subjects factor, and one within-subjects factor.
This mixed factorial design is also known as a split-plot design. (Note:
Do not confuse mixed factorial designs with mixed-effects models. The
former contain between- and within-subjects factors; the latter contain
fixed and random effects.)</p>
<p>This fictional data is based on the scenario at the beginning of this
vignette. Forty respondents, half adults and half children, were
surveyed for their favorite ice cream four times, once per season. Thus,
<code>Age</code> is a between-subjects factor with two levels
<code>{adult, child}</code>, and <code>Season</code> is a
within-subjects factor with four levels
<code>{fall, winter, spring, summer}</code>. The polytomous response,
<code>Pref</code>, has three categories:
<code>{vanilla, chocolate, strawberry}</code>. The <code>PId</code>
factor is repeated across rows, indicating respondents were queried four
times each, once per season.</p>
<p>Let’s load and prepare this data set:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">data</span>(icecream, <span class="at">package=</span><span class="st">&quot;multpois&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>icecream<span class="sc">$</span>PId <span class="ot">=</span> <span class="fu">factor</span>(icecream<span class="sc">$</span>PId)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>icecream<span class="sc">$</span>Pref <span class="ot">=</span> <span class="fu">factor</span>(icecream<span class="sc">$</span>Pref, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;vanilla&quot;</span>,<span class="st">&quot;chocolate&quot;</span>,<span class="st">&quot;strawberry&quot;</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>icecream<span class="sc">$</span>Age <span class="ot">=</span> <span class="fu">factor</span>(icecream<span class="sc">$</span>Age, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;adult&quot;</span>,<span class="st">&quot;child&quot;</span>))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>icecream<span class="sc">$</span>Season <span class="ot">=</span> <span class="fu">factor</span>(icecream<span class="sc">$</span>Season, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;fall&quot;</span>,<span class="st">&quot;winter&quot;</span>,<span class="st">&quot;spring&quot;</span>,<span class="st">&quot;summer&quot;</span>))</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">contrasts</span>(icecream<span class="sc">$</span>Age) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">contrasts</span>(icecream<span class="sc">$</span>Season) <span class="ot">&lt;-</span> <span class="st">&quot;contr.sum&quot;</span></span></code></pre></div>
<p>Let’s visualize this data set using a mosaic plot:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Age <span class="sc">+</span> Season <span class="sc">+</span> Pref, <span class="at">data=</span>icecream)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Pref by Age, Season&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;beige&quot;</span>,<span class="st">&quot;tan&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 5. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses for adults and children across the four seasons." src="data:image/png;base64,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" alt="Figure 5. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses for adults and children across the four seasons." />
<div class="figcaption"><strong>Figure 5.</strong> Proportions of
<code>vanilla</code> (beige), <code>chocolate</code> (brown), and
<code>strawberry</code> (pink) responses for adults and children across
the four seasons.</div>
</div>
<p>As in the previous example, we can use the multinomial-Poisson trick
to analyze repeated measures data with polytomous responses:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>m8 <span class="ot">=</span> <span class="fu">glmer.mp</span>(Pref <span class="sc">~</span> Age<span class="sc">*</span>Season <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>PId), <span class="at">data=</span>icecream)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">Anova.mp</span>(m8, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; Analysis of Deviance Table (Type III Wald chisquare tests)</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; Response: Pref</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; via the multinomial-Poisson trick</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt;              Chisq Df   N Pr(&gt;Chisq)   </span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; Age         8.8866  2 160   0.011757 * </span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Season     12.4627  6 160   0.052408 . </span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Age:Season 18.3213  6 160   0.005477 **</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We have a main effect of <code>Age</code> and an
<code>Age</code>×<code>Season</code> interaction but no main effect of
<code>Season</code>. We can explore this further by graphically
depicting response proportions in each age group:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Age <span class="sc">+</span> Pref, <span class="at">data=</span>icecream)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Pref by Age&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;beige&quot;</span>,<span class="st">&quot;tan&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 6. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses for adults and children. The main effect of Age emerges, with children preferring chocolate more and strawberry less than adults." src="data:image/png;base64,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" alt="Figure 6. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses for adults and children. The main effect of Age emerges, with children preferring chocolate more and strawberry less than adults." />
<div class="figcaption"><strong>Figure 6.</strong> Proportions of
<code>vanilla</code> (beige), <code>chocolate</code> (brown), and
<code>strawberry</code> (pink) responses for adults and children. The
main effect of <code>Age</code> emerges, with children preferring
chocolate more and strawberry less than adults.</div>
</div>
<p>The different proportions by <code>Age</code> clearly emerge,
explaining the main effect. Let’s also graphically depict the
proportions by <code>Season</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>xt <span class="ot">=</span> <span class="fu">xtabs</span>( <span class="sc">~</span> Season <span class="sc">+</span> Pref, <span class="at">data=</span>icecream)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">mosaicplot</span>(xt, <span class="at">main=</span><span class="st">&quot;Pref by Season&quot;</span>, <span class="at">las=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;beige&quot;</span>,<span class="st">&quot;tan&quot;</span>,<span class="st">&quot;pink&quot;</span>))</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Figure 7. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses by Season. Although there are some differences in proportion, they are not quite statistically significant (p = 0.052)." src="data:image/png;base64,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" alt="Figure 7. Proportions of vanilla (beige), chocolate (brown), and strawberry (pink) responses by Season. Although there are some differences in proportion, they are not quite statistically significant (p = 0.052)." />
<div class="figcaption"><strong>Figure 7.</strong> Proportions of
<code>vanilla</code> (beige), <code>chocolate</code> (brown), and
<code>strawberry</code> (pink) responses by <code>Season</code>.
Although there are some differences in proportion, they are not quite
statistically significant (<em>p</em> = 0.052).</div>
</div>
<p>Finally, we can again conduct <em>post hoc</em> pairwise comparisons.
Note, however, there are many such possible comparisons, and best
practice would require us to only conduct those comparisons driven by
hypotheses or planned in advance. For example, we might wish to limit
our pairwise comparisons to adults vs. children <em>within each
season</em>, not across all seasons. In any case, we first conduct all
pairwise comparisons just for illustration:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">glmer.mp.con</span>(m8, pairwise <span class="sc">~</span> Age<span class="sc">*</span>Season, <span class="at">adjust=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt;                       Contrast     Chisq Df  N  p.value</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt; 1    adult.fall - adult.spring  9.050067  2 40 0.260016</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">#&gt; 2    adult.fall - adult.summer  0.425876  2 40 1.000000</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; 3    adult.fall - adult.winter  4.153318  2 40 1.000000</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; 4      adult.fall - child.fall  8.128467  2 40 0.377872</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; 5    adult.fall - child.spring  1.222476  2 40 1.000000</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; 6    adult.fall - child.summer  2.136531  2 40 1.000000</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt; 7    adult.fall - child.winter  3.642132  2 40 1.000000</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt; 8  adult.spring - adult.summer  7.611634  2 40 0.447111</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt; 9  adult.spring - adult.winter 14.903020  2 40 0.015820</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt; 10   adult.spring - child.fall 14.957280  2 40 0.015820</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co">#&gt; 11 adult.spring - child.spring 13.775930  2 40 0.026520</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt; 12 adult.spring - child.summer 13.630800  2 40 0.027425</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt; 13 adult.spring - child.winter  8.577409  2 40 0.315629</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="co">#&gt; 14 adult.summer - adult.winter  3.697318  2 40 1.000000</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co">#&gt; 15   adult.summer - child.fall  7.059671  2 40 0.556890</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co">#&gt; 16 adult.summer - child.spring  2.676090  2 40 1.000000</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt; 17 adult.summer - child.summer  2.026498  2 40 1.000000</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a><span class="co">#&gt; 18 adult.summer - child.winter  1.974121  2 40 1.000000</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="co">#&gt; 19   adult.winter - child.fall  1.368363  2 40 1.000000</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a><span class="co">#&gt; 20 adult.winter - child.spring  3.817685  2 40 1.000000</span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co">#&gt; 21 adult.winter - child.summer  0.429746  2 40 1.000000</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a><span class="co">#&gt; 22 adult.winter - child.winter  2.355143  2 40 1.000000</span></span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a><span class="co">#&gt; 23   child.fall - child.spring  7.698948  2 40 0.447111</span></span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a><span class="co">#&gt; 24   child.fall - child.summer  2.976095  2 40 1.000000</span></span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a><span class="co">#&gt; 25   child.fall - child.winter  4.253790  2 40 1.000000</span></span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a><span class="co">#&gt; 26 child.spring - child.summer  2.069340  2 40 1.000000</span></span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a><span class="co">#&gt; 27 child.spring - child.winter  6.222227  2 40 0.801918</span></span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a><span class="co">#&gt; 28 child.summer - child.winter  2.146742  2 40 1.000000</span></span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: holm method for 28 tests&quot;</span></span></code></pre></div>
<p>If we wished to compare adults vs. children in each season (fall,
winter, spring, and summer), we would first conduct all pairwise
comparisons, leaving them <em>uncorrected</em> for multiple
comparisons…</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">glmer.mp.con</span>(m8, pairwise <span class="sc">~</span> Age<span class="sc">*</span>Season, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt; $heading</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pairwise comparisons via the multinomial-Poisson trick&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; $contrasts</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt;                       Contrast     Chisq Df  N  p.value</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; 1    adult.fall - adult.spring  9.050067  2 40 0.010834</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; 2    adult.fall - adult.summer  0.425876  2 40 0.808206</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt; 3    adult.fall - adult.winter  4.153318  2 40 0.125348</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt; 4      adult.fall - child.fall  8.128467  2 40 0.017176</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt; 5    adult.fall - child.spring  1.222476  2 40 0.542679</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt; 6    adult.fall - child.summer  2.136531  2 40 0.343604</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; 7    adult.fall - child.winter  3.642132  2 40 0.161853</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; 8  adult.spring - adult.summer  7.611634  2 40 0.022241</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt; 9  adult.spring - adult.winter 14.903020  2 40 0.000581</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt; 10   adult.spring - child.fall 14.957280  2 40 0.000565</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt; 11 adult.spring - child.spring 13.775930  2 40 0.001020</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; 12 adult.spring - child.summer 13.630800  2 40 0.001097</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt; 13 adult.spring - child.winter  8.577409  2 40 0.013723</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt; 14 adult.summer - adult.winter  3.697318  2 40 0.157448</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt; 15   adult.summer - child.fall  7.059671  2 40 0.029310</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt; 16 adult.summer - child.spring  2.676090  2 40 0.262358</span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt; 17 adult.summer - child.summer  2.026498  2 40 0.363038</span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="co">#&gt; 18 adult.summer - child.winter  1.974121  2 40 0.372670</span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a><span class="co">#&gt; 19   adult.winter - child.fall  1.368363  2 40 0.504503</span></span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a><span class="co">#&gt; 20 adult.winter - child.spring  3.817685  2 40 0.148252</span></span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a><span class="co">#&gt; 21 adult.winter - child.summer  0.429746  2 40 0.806644</span></span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a><span class="co">#&gt; 22 adult.winter - child.winter  2.355143  2 40 0.308026</span></span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a><span class="co">#&gt; 23   child.fall - child.spring  7.698948  2 40 0.021291</span></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a><span class="co">#&gt; 24   child.fall - child.summer  2.976095  2 40 0.225813</span></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a><span class="co">#&gt; 25   child.fall - child.winter  4.253790  2 40 0.119207</span></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a><span class="co">#&gt; 26 child.spring - child.summer  2.069340  2 40 0.355344</span></span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a><span class="co">#&gt; 27 child.spring - child.winter  6.222227  2 40 0.044551</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a><span class="co">#&gt; 28 child.summer - child.winter  2.146742  2 40 0.341854</span></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a><span class="co">#&gt; $notes</span></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P value adjustment: none method for 28 tests&quot;</span></span></code></pre></div>
<p>…and then we would extract the relevant comparisons (rows 4, 22, 11,
and 17, respectively), and manually correct their <em>p</em>-values to
guard against Type I errors, like so:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(<span class="fl">0.017176</span>, <span class="fl">0.308026</span>, <span class="fl">0.001020</span>, <span class="fl">0.363038</span>), <span class="at">method=</span><span class="st">&quot;holm&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.051528 0.616052 0.004080 0.616052</span></span></code></pre></div>
<p>Thus, after correction using Holm’s sequential Bonferroni procedure
<a href="https://www.jstor.org/stable/4615733">(Holm 1979)</a>, we see
that adults vs. children in <strong>spring</strong> are significantly
different (<em>p</em> &lt; .05). Looking again at Figure 5 visually
confirms this result.</p>
<center>
<p>Copyright (C) 2024-2025 Jacob O. Wobbrock &lt;<a href="mailto:wobbrock@uw.edu" class="email">wobbrock@uw.edu</a>&gt;</p>
</center>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
